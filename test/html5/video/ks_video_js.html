<html>

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=3.0">
  <style type="text/css">
    .video_top {
      position: relative;
      width: 150px;
      height: 200px;
      left: 180px;
      top: -220px;
      background: #0C0;
      z-index: 997;
    }
  </style>
  <script>
    const load = () => {
      console.log("load event detected!");
      document.getElementById('idJsUa').innerHTML = navigator.userAgent;
    }
    window.onload = load;
  </script>
  <!--
    https://w1-pro.kskwai.com/kos/nlav11066/eve2022/pickNumber/zhuhuichang_inner_brand_video_1_v.mp4
    
  -->
</head>

<body>

  <div id='container'>
<!--
  <video id="ovideo" useksplayer="video" autoplay="" loop src="../../video/beiwa_iqiyi_05.mp4" style="width: 100%; object-fit: cover;"></video>
-->
  
  
  </div>

  <div style="position: fixed; z-index: 999; top: 150px; text-align:right;">
    <button onclick="insertKsVideo()">Insert KsVideo</button>
    <br/><br/>
    <button onclick="attachOrDetachKsVideo()">Attach/Detach KsVideo</button>
    <br/><br/>
    <button onclick="callInterface()">Call Interface</button>
    <br/><br/>
    <button onclick="playOrPause()">播放或暂停</button>
    <br /><br />
    <button onclick="media_switch_src()">media_switch_src</button>
    <br /><br />
    <button onclick="location.reload()">重新加载</button>
    <br /><br />
    <br /><br />
    <a href="http://yimingapp.cn/test">yimingapp.cn/test</a>
    <div id="idJsUa">
      
    </div>
  </div>

  <script>

  function appendInnerHtml(html_str) {
    document.getElementById('container').insertAdjacentHTML('beforeend', html_str);
  }


  const init_url = "../../video/heart_636_12_28.mp4";
  var video_url = "../../video/beiwa_iqiyi_05.mp4";
  
  //const video_url = "https://zhaopeng06.xxxxxxx.kuaishou.com/public/h264-720-1.mp4";
  //autoplay="autoplay"
  //autoplay="true" 
  function insertKsVideo() {
    let url = init_url + "?random=" + Math.random();
    var html_str = '<video id="ksvideo" useksplayer="video" autoplay  loop="loop" controls="controls" src=' + url + '></video';
    appendInnerHtml(html_str);
    gVideo = document.getElementById('ksvideo');
    initvideo(gVideo);
    //gVideo.muted = true;
    // gVideo.updatelivesrc("haha updatelivesrc url000000000000000000");
  }

  var gVideo;
  function attachOrDetachKsVideo() {
    var ov = document.getElementById('ksvideo');
    if (ov == gVideo) {
      document.getElementById('container').removeChild(gVideo);
    } else {
      document.getElementById('container').appendChild(gVideo);
    }
  }

  function callInterface() {
    gVideo.updatelivesrc("callInterface 111");
  }
  
  function playOrPause() {
      if (gVideo.paused) {
        gVideo.play();
      } else {
        gVideo.pause();
      }
      console.log("gqg3: abplay=true ================================================");
  }

  function media_switch_src() {
    var tmp_url = gVideo.src;
    gVideo.src = video_url;
    //gVideo.currentTime = 0;
    console.log("gqg3: switch url=" + video_url);
    video_url = tmp_url;
  }

  function initvideo(ovideo) {

    ovideo.onerror = function (e) {
      console.log("gqg5: ovideo.onerror 000000000000000000000000000000");
      let s = "";
      let err = ovideo.error;
      console.log("gqg5: ovideo.onerror ovideo.error=" + ovideo.error);
      let message = err.message;

      if (message && message.length) {
        s += " " + message;
      }
      console.log("gqg5: ovideo.onerror s=" + s);
    }

    ovideo.addEventListener("durationchange", function (e) {
      console.log("gqg3: durationchange ovideo.duration=" + ovideo.duration);
    });
    ovideo.addEventListener("playing", function (e) {
      console.log("gqg6: addEventListener　playing ovideo.duration=" + ovideo.duration);
    });
    ovideo.addEventListener("waiting", function (e) {
      console.log("gqg6: addEventListener　waiting ovideo.duration=" + ovideo.duration);
    });

    ovideo.addEventListener("loadstart", function (e) {
      console.log("gqg3: addEventListener　loadstart");
    });
    ovideo.addEventListener("load", function (e) {
      console.log("gqg3: addEventListener　load....");
    });
    ovideo.addEventListener("ended", function (e) {
      console.log("gqg3: ended=true");
    });
    ovideo.addEventListener("abended", function (e) {
      console.log("gqg3: addEventListener abended=true");
    });
    ovideo.onabended = function () {
      console.log("gqg3: onabended=true  ================================================");
    }
    ovideo.addEventListener("firstframe", function (e) {
      console.log("gqg3: addEventListener firstframe=true");
    });
    ovideo.onfirstframe = function () {
      console.log("gqg3: onfirstframe=true");
    }

    ovideo.onplaying = function () {
      console.log("gqg3: ovideo.onplaying ovideo.duration=" + ovideo.duration);
    }
    ovideo.addEventListener('timeupdate', (event) => {
		  console.log("gqg3: timeupdate currentTime=" + gVideo.currentTime + "; timeStamp=" + event.timeStamp)
	  });
  }

  </script>
  <br /><br />

</body>

</html>