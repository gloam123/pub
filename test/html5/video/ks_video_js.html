<html>

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=3.0">
  <style type="text/css">
    .video_top {
      position: relative;
      width: 150px;
      height: 200px;
      left: 180px;
      top: -220px;
      background: #0C0;
      z-index: 997;
    }
  </style>
  <script>
    const load = () => {
      console.log("load event detected!");
      document.getElementById('idJsUa').innerHTML = navigator.userAgent;
    }
    window.onload = load;
  </script>
  <!--
    https://w1-pro.kskwai.com/kos/nlav11066/eve2022/pickNumber/zhuhuichang_inner_brand_video_1_v.mp4
    
  -->
</head>

<body>

  <div id='container'>
<!--
  <video id="ovideo" useksplayer="video" autoplay="" loop src="../../video/beiwa_iqiyi_05.mp4" style="width: 100%; object-fit: cover;"></video>
-->
  
  
  </div>

  <div style="position: fixed; z-index: 999; top: 150px; text-align:right;">
    <button onclick="insertKsVideo()">Insert KsVideo</button>
    <br/><br/>
    <button onclick="attachOrDetachKsVideo()">Attach/Detach KsVideo</button>
    <br/><br/>
    <button onclick="callInterface()">Call Interface</button>
    <br/><br/>
    <button onclick="playOrPause()">播放或暂停</button>
    <br /><br />
    <button onclick="location.reload()">重新加载</button>
    <br /><br />
    <br /><br />
    <a href="http://yimingapp.cn/test">yimingapp.cn/test</a>
    <div id="idJsUa">
      
    </div>
  </div>

  <script>

  function appendInnerHtml(html_str) {
    document.getElementById('container').insertAdjacentHTML('beforeend', html_str);
  }

  const video_url = "https://zhaopeng06.kproxy.corp.kuaishou.com/public/h264-720-1.mp4";
  //const video_url = "https://zhaopeng06.xxxxxxx.kuaishou.com/public/h264-720-1.mp4";
  //autoplay="autoplay"
  //autoplay="true" 
  function insertKsVideo() {
    let url = video_url + "?random=" + Math.random();
    var html_str = '<video id="ksvideo" useksplayer="video"  loop="loop" controls="controls" src=' + url + '></video';
    appendInnerHtml(html_str);
    gVideo = document.getElementById('ksvideo');
    gVideo.muted = true;
    // gVideo.updatelivesrc("haha updatelivesrc url000000000000000000");
  }

  var gVideo;
  function attachOrDetachKsVideo() {
    var ov = document.getElementById('ksvideo');
    if (ov == gVideo) {
      document.getElementById('container').removeChild(gVideo);
    } else {
      document.getElementById('container').appendChild(gVideo);
    }
  }

  function callInterface() {
    gVideo.updatelivesrc("callInterface 111");
  }
  
  function playOrPause() {
      if (gVideo.paused) {
        gVideo.play();
      } else {
        gVideo.pause();
      }
      console.log("gqg3: abplay=true ================================================");
  }

  function initvideo(ovideo) {

    ovideo.onerror = function (e) {
      console.log("gqg5: ovideo.onerror 000000000000000000000000000000");
      let s = "";
      let err = ovideo.error;
      console.log("gqg5: ovideo.onerror ovideo.error=" + ovideo.error);

      switch (err.code) {
        case MediaError.MEDIA_ERR_ABORTED:
          s += "The user canceled the audio.";
          break;
        case MediaError.MEDIA_ERR_NETWORK:
          s += "A network error occurred while fetching the audio.";
          break;
        case MediaError.MEDIA_ERR_DECODE:
          s += "An error occurred while decoding the audio.";
          break;
        case MediaError.MEDIA_ERR_SRC_NOT_SUPPORTED:
          s += "The audio is missing or is in a format not supported by your browser.";
          break;
        default:
          s += "An unknown error occurred.";
          break;
      }

      let message = err.message;

      if (message && message.length) {
        s += " " + message;
      }
      console.log("gqg5: ovideo.onerror s=" + s);
      //ovideo.src = "https://txmov2.a.yximgs.com/bs2/newWatermark/MzU4MTk4OTQ2NjA_zh_3.mp4?a=2222222";
    }

    ovideo.addEventListener("durationchange", function (e) {
      console.log("gqg3: durationchange ovideo.duration=" + ovideo.duration);
    });
    ovideo.addEventListener("playing", function (e) {
      console.log("gqg6: addEventListener　playing ovideo.duration=" + ovideo.duration);
    });
    ovideo.addEventListener("waiting", function (e) {
      console.log("gqg6: addEventListener　waiting ovideo.duration=" + ovideo.duration);
    });

    ovideo.addEventListener("loadstart", function (e) {
      console.log("gqg3: addEventListener　loadstart");
    });
    ovideo.addEventListener("load", function (e) {
      console.log("gqg3: addEventListener　load....");
    });
    ovideo.addEventListener("ended", function (e) {
      console.log("gqg3: ended=true");
    });
    ovideo.addEventListener("abended", function (e) {
      console.log("gqg3: addEventListener abended=true");
    });
    ovideo.onabended = function () {
      console.log("gqg3: onabended=true  ================================================");
    }
    ovideo.addEventListener("firstframe", function (e) {
      console.log("gqg3: addEventListener firstframe=true");
    });
    ovideo.onfirstframe = function () {
      console.log("gqg3: onfirstframe=true");
    }

    ovideo.onplaying = function () {
      console.log("gqg3: ovideo.onplaying ovideo.duration=" + ovideo.duration);
    }
  }


  </script>
  <br /><br />

</body>

</html>